dist: xenial

language: python

matrix:
  include:
    - python: pypy3.5-6.0.0
    - python: pypy3.6-7.0.0
    - python: 3.5
    - python: 3.6
    - python: 3.7
    - python: 3.8

install:
  - python -m pip install --upgrade pip setuptools
  - python -m pip install --upgrade codecov
  - python -m pip install --force-reinstall -r requirements.txt
  - python -m pip install --force-reinstall -r requirements-tests.txt

script:
  - pytest
  - python -m doctest README.md

after_success:
  - python -m codecov -f coverage.xml -X gcov

deploy:
  provider: pypi
  on:
    branch: master
    python: 3.5
  user: __token__
  password:
    secure: eqlVyS1qFzPreZ47m2SNnX5NE0ecrA3QJ/F6BngNziOb47hWBKYC/apTXllOO5DVYBTcYSb8Fg8yJgxHEaVxwp8U/tWCs2rQM9Ocd+QhtDEueUrVNKDpij0EOpAktqb6idExSoE8nRWwY0MKSDTONIH1koEOs4yIBRBheQxHuminLBdcPcR759AMdwbVqpcl750L8L+hAq1ugaHpHgfYk43h3okl3kj1DJLUjeleDJOxICfbqoGF64xp6TMi9zKlWc8VWiXKLJgiKbEJ4g1kSkso5Z4ENCecZnliu7ydoe743JNq0w55EFRBiGdrhV3zr8BttKI2Q66vTBq1QwL4qN4jal8Rl6KPonPBq9koXTWH7GvZRskrRLW93YBdDsAueLO09OX9CCSetqoqwgjsH1qKsfsoWyqg8pHKBEvC44DhvsG/ADXClVH6L5gk9CWGm/dLfunJaMmWlvJ0hE5mZq5ufZCZMCEGCqkd7Rm/ClXGgag6gRAcLDOc6P3w7hZl0hzvx2EpSVViXbGgKfT3F0ekcT9WffDRq18iziMGWmXAa8u45DE2g8cg3WshXWMexb010urvkmaG9caSRiAobtt5T8pQM82zIEhiqMZGWeX5AOMAkPL7NKX/458eRDXqa2BJCnW/kNNJNqKEnCVIVsCDMwHBdOEJkHHukNrr8Wk=
  distributions: sdist bdist_wheel
  skip_existing: true
